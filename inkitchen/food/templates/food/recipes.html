{% extends 'main/base.html' %}
{% load static %}

{% block title %}Все рецепты{% endblock %}

{% block content %}
<div id="recipe_page_container">
    <div id="days_order_block">
        {% for day, data in plan_menu.items %}
            <div>
                <a href="{% url 'delivery_day' day %}" class="week_day-delivery">{{ day }}</a>
                <!--<p class="week_day-delivery"></p>-->
                <!--<p>{{ data.delivery_date }}</p>-->
                <p class="gty_per_day">0/{{ data.qty_meals }}</p>
            </div>
        {% endfor %}
    </div>

    <div id="filter_recipes_block">

    </div>

    <div id="recipes-list">
        {% for recipe in recipes %}
        <div class="recipe-wrapper">
            <a href="{% url 'recipe_details' recipe.slug %}" class="recipe">
                <div class="recipe-photo">
                    <img src="{{ recipe.image.url }}" alt="рецепт">
                </div>
            </a>
            <div class="recipe-info-wrap">
                <div class="recipe-title-wrap">
                    <h3>{{ recipe.title }}</h3>
                </div>
                <div class="recipe-info-block">
                    <div class="kkal-info">
                        {{ recipe.kkal }}
                        <p>ккал</p>
                    </div>
                    <div class="p_f_c-info">
                        {{ recipe.protein }}/{{ recipe.fat }}/{{ recipe.carbohydrates }}
                        <p>БЖУ</p>
                    </div>
                    <div class="add-recipe-btn-wrap">
                        <!--<form method="post" action="{% url 'cart_add' recipe.id %}" class="form_recipe_add">-->
                        <form method="post" action="{% url 'add_to_cart' %}" class="form_recipe_add">
                            {% csrf_token %}
                            <button class="btn-add-recipe" type="submit"
                                    data-recipe="{{ recipe.id }}"
                                    data-name="{{ recipe.title }}"
                                    data-image="{{ recipe.image.url }}">+</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

        <!---------------------------------- корзина для рецептов ----------------------------------->

    <div id="cart_recipes_page_wrap">
        <div id="cart_head">
            <h2 class="title-main-page">КОРЗИНА</h2>
            <div id="delivery_day">
                <p>Доставка планируется</p>
            </div>
        </div>
        <div id="cart_recipes_block">
            {% for item in cart_items %}
            <div class="cart-item" id="recipe_id_{{ item.id }}">
                <div class="aside">
                    <a href="{% url 'recipe_details' item.recipe.slug %}">
                        <img src="{{ item.recipe.imageURL }}" class="img-sm">
                    </a>
                </div>
                <div class="info">
                    <div class="info-title">
                        <a href="{% url 'recipe_details' item.recipe.slug %}" class="title text-dark" data-abc="true">
                            {{ item.recipe.title }}
                        </a>
                        <!--Кнопка удаления рецепта-->
                        <form action="{% url 'remove_from_cart' item.id %}">
                            <button type="submit" class="btn btn-sm">x</button>
                        </form>
                    </div>
                        <!--Кнопки изменения кол-ва рецепта в корзине-->
                    <div class="meal_count_cart">
                        <button type="button" onclick="this.nextElementSibling.stepDown()" class="minus">-</button>
                        <input type="number" min="0" max="99" value="{{ item.q_portion }}" readonly class="raz">
                        <button type="button" onclick="this.previousElementSibling.stepUp()" class="plus">+</button>
                    </div>
                </div>
                <!--<form class="form-inline" method="post" action="{% url 'adjust_cart' item.id %}">
                    {% csrf_token %}
                    <div class="form-group" style="margin: 0;">
                        <div class="input-group qty-recipe">
                            <input placeholder="{{ item.q_portion }}" name="quantity" type="number" min="0" max="999" class="form-control">
                        </div>
                    </div>
                    <button type="submit" class="btn btn-secondary btn-sm">Изменить</button>
                </form>-->
			</div>
            {% endfor %}
        </div>
        <div id="next_btn_wrap">
            <h4>0/{{ weekday.qty_meals }} Блюд</h4>
            {% if request.session.cart|length != request.session.plan_menu %}
            <a href="{% url 'order_create' %}" role="button" aria-disabled="true" id="disable-btn-next-order">
                Далее
            </a>
            {% else %}
            <a href="{% url 'order_create' %}" role="button" aria-pressed="true" id="active-btn-next-order">
                Далее
            </a>
            {% endif %}
        </div>
    </div>
</div>
<script type="text/javascript" src="{% static 'main/js/recipes.js' %}"></script>
{% endblock content %}
